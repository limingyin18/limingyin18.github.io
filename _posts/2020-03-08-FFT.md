---
layout: post
title: "FFT"
date: 2002-03-08
categories: math
tags: [fft]
---



# Fourier Transform
$$f(x) = \int^{\infty}_{-\infty}F(\omega)e^{i\omega x}d\omega$$ 
$$F(x) = \int^{\infty}_{-\infty}f(x)e^{-i\omega x}dx$$ 

# Discrete Fourier Transform
$$x[n] = \frac{1}{N}\sum^{N-1}_{k=0}X[k]e^{i\frac{2\pi k}{N}n}$$ 
$$X[k] = \sum^{N-1}_{n=0}x[n]e^{-i\frac{2\pi k}{N}n}$$

# Fast Fourier Transform}
By far the most commonly used FFT is the Cooleyâ€“Tukey algorithm. This is a divide and conquer algorithm that recursively breaks down a DFT of any composite size $N = N_1N_2$ into many smaller DFTs of sizes $N_1$ and $N_2$, along with $O(N)$ multiplications.

\begin{figure}[h]
\includegraphics[width=\textwidth]{images/dft.png}
\centering
\caption{DFT}
\label{fig:DFT}
\end{figure}
\begin{figure}[h]
\includegraphics[width=\textwidth]{images/parityGrouping.png}
\centering
\caption{Parity grouping}
\label{fig:parityGrouping}
\end{figure}
Figure show a directly DFT. For FFT, parity grouping inputs as figure show. Let $W^k_N=e^{-i\frac{2\pi k}{N}}$,
for $k\in\{0, 1, ..., N/2-1\}$:
$$G[k]= \sum^{\frac{N}{2}-1}_{n=0}g[n]e^{-i\frac{2\pi k}{N/2}n}=\sum^{\frac{N}{2}-1}_{n=0}x[2n]e^{-i\frac{2\pi k}{N}2n}$$

$$H[k]=\sum^{\frac{N}{2}-1}_{n=0}h[n]e^{-i\frac{2\pi k}{N/2}n}=\sum^{\frac{N}{2}-1}_{n=0}x[2n+1]e^{-i\frac{2\pi k}{N}2n} = e^{i\frac{2\pi k}{N}}\sum^{\frac{N}{2}-1}_{n=0}x[2n+1]e^{-i\frac{2\pi k}{N}2n+1}$$
$$X[k]=\sum^{N-1}_{n=0}x[n]e^{-i\frac{2\pi k}{N}n} = \sum^{\frac{N}{2}-1}_{n=0}x[2n]e^{-i\frac{2\pi k}{N}2n} + \sum^{\frac{N}{2}-1}_{n=0}x[2n+1]e^{-i\frac{2\pi k}{N}2n+1} \\
= G[k] + W^k_nH[k]$$

for $k\in\{N/2, N/2+1, ..., N-1\}$, let $K= k-N/2$, so $K\in \{0, 1, ..., N/2-1\}$:
$$X[k]=\sum^{N-1}_{n=0}x[n]e^{-i\frac{2\pi k}{N}n} = \sum^{\frac{N}{2}-1}_{n=0}x[2n]e^{-i\frac{2\pi k}{N}2n} + \sum^{\frac{N}{2}-1}_{n=0}x[2n+1]e^{-i\frac{2\pi k}{N}2n+1} \\
= \sum^{\frac{N}{2}-1}_{n=0}x[2n]e^{-i\frac{2\pi (K+\frac{N}{2})}{N}2n} + \sum^{\frac{N}{2}-1}_{n=0}x[2n+1]e^{-i\frac{2\pi (K+\frac{N}{2})}{N}2n+1} \\
    = \sum^{\frac{N}{2}-1}_{n=0}x[2n]e^{-i\frac{2\pi K}{N}2n} + e^{-i\pi}\sum^{\frac{N}{2}-1}_{n=0}x[2n+1]e^{-i\frac{2\pi K}{N}2n+1} \\
    = G[K] + e^{-i\pi}W^K_NH[K] \\
    = G[k-\frac{N}{2}] + W^k_NH[k-\frac{N}{2}]$$

\begin{figure}[h]
\includegraphics[width=\textwidth]{images/butterFly.png}
\centering
\caption{Butter fly}
\label{fig:butterFly}
\end{figure}
notice $W^{k+\frac{N}{2}}_{N} = -W^{k}_{N}$, have transform as figure \ref{fig:butterFly} show.
for example, $N=8$:
\begin{figure}[h]
\includegraphics[width=\textwidth]{images/radix2.png}
\centering
\caption{radix2 fft for a length-8 signal}
\label{fig:radix2}
\end{figure}

The input order can be determined by the bit reversed algorithm as shown in figure \ref{fig:bitReversed}.
\begin{figure}[h]
\includegraphics[width=\textwidth]{images/bitReversed.png}
\centering
\caption{Bit reversed}
\label{fig:bitReversed}
\end{figure}

# Reference
1. Fast Fourier transform, https://en.wikipedia.org/wiki/Fast_Fourier_transform
2. Decimation-in-time (DIT) Radix-2 FFT, https://cnx.org/contents/zmcmahhR@7/Decimation-in-time-DIT-Radix-2-FFT